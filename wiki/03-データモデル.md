# ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

## ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸é…ç½®ã¨å½¢å¼
- å®Ÿè¡Œæ™‚ DB ã¯ SQLiteã€Windows ã¯ `%APPDATA%/TeraDock/teradock.db`ã€Linux ã¯ `~/.config/teradock/teradock.db` ã«ç½®ãã€‚ã€F:PROJECT_PLAN.mdâ€ L50-L66ã€‘
- Export/Import ã¯ JSON åŸºæœ¬ï¼ˆå¿…è¦ã«å¿œã˜ã¦ TOML ã‚’è¿½åŠ ï¼‰ã€‚ã€F:PROJECT_PLAN.mdâ€ L52-L55ã€‘
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯åŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã® `logs/` ã«ä¿å­˜ã—ã€Secret ã‚’å«ã‚ãªã„ã€‚ã€F:PROJECT_PLAN.mdâ€ L60-L64ã€‘ã€F:PROJECT_PLAN.mdâ€ L338-L343ã€‘

## ãƒ†ãƒ¼ãƒ–ãƒ«æ¦‚è¦
- `settings`: ã‚­ãƒ¼å€¤ã‚¹ãƒˆã‚¢ï¼ˆä¾‹: `schema_version`, client overridesï¼‰ã€‚ã€F:PROJECT_PLAN.mdâ€ L68-L129ã€‘
- `profiles`: æ¥ç¶šå…ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ client overridesã€‚ã€F:PROJECT_PLAN.mdâ€ L72-L83ã€‘
- `ssh_forwards` / `ssh_jump`: SSH å°‚ç”¨ã® forward ã¨ jump è¨­å®šã€‚ã€F:PROJECT_PLAN.mdâ€ L78-L85ã€‘
- `secrets`: Argon2id + XChaCha20 ã§æš—å·åŒ–ã—ãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæœ¬ä½“ã€‚ã€F:PROJECT_PLAN.mdâ€ L85-L92ã€‘
- `cmdsets` / `cmdsteps` / `parsers`: ã‚³ãƒãƒ³ãƒ‰ã‚»ãƒƒãƒˆã¨å‡ºåŠ›ãƒ‘ãƒ¼ã‚µå®šç¾©ã€‚ã€F:PROJECT_PLAN.mdâ€ L92-L107ã€‘ã€F:PROJECT_PLAN.mdâ€ L286-L317ã€‘
- `configsets` / `configfiles`: è¨­å®šé…å¸ƒãƒ¦ãƒ‹ãƒƒãƒˆã¨é…å¸ƒå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ã€F:PROJECT_PLAN.mdâ€ L107-L116ã€‘ã€F:PROJECT_PLAN.mdâ€ L264-L283ã€‘
- `op_logs`: ç›£æŸ»ç”¨ã®å®Ÿè¡Œãƒ­ã‚°ï¼ˆSecret ã¯å«ã‚ãªã„ï¼‰ã€‚ã€F:PROJECT_PLAN.mdâ€ L117-L127ã€‘ã€F:PROJECT_PLAN.mdâ€ L338-L343ã€‘

```mermaid
erDiagram
  profiles ||--o{ ssh_forwards : has
  profiles ||--|| ssh_jump : uses
  profiles ||--o{ op_logs : referencedBy
  profiles ||--o{ cmdsets : mayExecute
  cmdsets ||--o{ cmdsteps : contains
  cmdsteps }o--|| parsers : optional
  configsets ||--o{ configfiles : bundles
  secrets ||--|| profiles : optionalBinding
```

## ã‚µãƒ³ãƒ—ãƒ«ã‚¹ã‚­ãƒ¼ãƒæŠœç²‹
```sql
-- profiles capture host info and client overrides
CREATE TABLE profiles (
  profile_id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  type TEXT NOT NULL, -- ssh | telnet | serial
  host TEXT,
  port INTEGER,
  user TEXT,
  danger_level TEXT,
  client_overrides_json TEXT,
  created_at INTEGER,
  updated_at INTEGER,
  last_used_at INTEGER
);
-- Source: PROJECT_PLAN.md L72-L83
```

## ç§»è¡Œã¨ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³
- `schema_version` ã‚’ `settings` ã§ä¿æŒã™ã‚‹ã‹ã€`refinery` ãªã©ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã§æ®µéšé©ç”¨ã™ã‚‹æ–¹é‡ã€‚ã€F:PROJECT_PLAN.mdâ€ L128-L129ã€‘
- æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ æ™‚ã¯ idempotent ãªãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †ã‚’ç”¨æ„ã—ã€`td --version` å®Ÿè¡Œæ™‚ã«è‡ªå‹•é©ç”¨ã™ã‚‹è¨ˆç”»ã€‚ã€F:PROJECT_PLAN.mdâ€ L397-L408ã€‘

è©³ç´°ãªæ“ä½œæ‰‹é †ã¯ [æ©Ÿèƒ½ã¨UX](./04-æ©Ÿèƒ½ã¨UX.md) ã‚’å‚ç…§ã€‚
