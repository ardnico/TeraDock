# ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

## ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ§‹æˆï¼ˆè¨ˆç”»ï¼‰
- `crates/core`: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã€æ°¸ç¶šåŒ–ã€æš—å·ã€å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ç”Ÿæˆã€‚ã€F:PROJECT_PLAN.mdâ€ L26-L44ã€‘
- `crates/cli`: clap ãƒ™ãƒ¼ã‚¹ã® CLI ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ API å‘¼ã³å‡ºã—ã®ã¿ï¼‰ã€‚ã€F:PROJECT_PLAN.mdâ€ L26-L33ã€‘
- `crates/tui`: ratatui + crossterm ã«ã‚ˆã‚‹ TUIï¼ˆæ¤œç´¢ãƒ»ç¢ºèªãƒ»å®Ÿè¡Œï¼‰ã€‚ã€F:PROJECT_PLAN.mdâ€ L26-L46ã€‘
- `crates/common` (ä»»æ„): ID æ­£è¦åŒ–ã‚„å…±é€šã‚¨ãƒ©ãƒ¼å‹ã®å…±æœ‰å±¤ã€‚ã€F:PROJECT_PLAN.mdâ€ L26-L33ã€‘

```mermaid
flowchart TB
  subgraph Presentation
    cli[CLI]
    tui[TUI]
  end
  subgraph Core
    domain[Domain rules\nID rules, danger guard]
    usecase[Usecases\nconnect/exec/run/etc]
  end
  subgraph Infra
    db[(SQLite)]
    crypto[Crypto\nArgon2id + XChaCha20]
    extcmd[External cmds\nssh/scp/sftp/telnet]
    serial[Serial passthrough]
  end
  cli --> usecase
  tui --> usecase
  usecase --> domain
  usecase --> db
  usecase --> crypto
  usecase --> extcmd
  usecase --> serial
```

## å¤–éƒ¨ä¾å­˜ã¨ OS å·®åˆ†
- æ¥ç¶šãƒ»è»¢é€ã¯ OS ã®å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã‚’ç›´æ¥èµ·å‹•ã—ã€ã‚·ã‚§ãƒ«ã¯ä»‹ã•ãªã„ï¼ˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å›é¿ï¼‰ã€‚ã€F:PROJECT_PLAN.mdâ€ L181-L199ã€‘
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè§£æ±ºã¯ profile override â†’ global settings â†’ PATH æ¢ç´¢ã®é †ã§æ±ºå®šã™ã‚‹ã€‚ã€F:PROJECT_PLAN.mdâ€ L190-L195ã€‘
- `td doctor` ã§ ssh/scp/sftp/telnet ã®æœ‰ç„¡ã¨ TUI å®Ÿè¡Œå¯å¦ã‚’æ¤œæŸ»ã—ã€æ¬ è½æ™‚ã«ä»£æ›¿æ¡ˆã‚’æç¤ºã™ã‚‹ã€‚ã€F:EXTERNAL_DESIGN.mdâ€ L35-L53ã€‘

## ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆæ¦‚å¿µï¼‰
```mermaid
sequenceDiagram
  participant User
  participant CLI
  participant Core
  participant SystemCmd as ssh/scp/sftp/telnet
  participant SQLite
  User->>CLI: td connect <profile>
  CLI->>Core: Resolve profile & danger guard
  Core->>SystemCmd: spawn with masked args
  Core->>SQLite: log op (no secrets)
  SystemCmd-->>User: interactive session
```

## äºˆå®šã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¹ã‚±ãƒƒãƒ
```bash
crates/
  core/        # Domain + usecases + infra adapters
  cli/         # CLI args -> core API
  tui/         # Ratatui screens & actions
  common/      # Shared validators & error types (optional)
```

è©³ç´°ãªãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã¯ [ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«](./03-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«.md)ã€æ“ä½œãƒ•ãƒ­ãƒ¼ã¯ [æ©Ÿèƒ½ã¨UX](./04-æ©Ÿèƒ½ã¨UX.md) ã‚’å‚ç…§ã€‚
